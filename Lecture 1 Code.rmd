---
title: 'Lecture 1: Introduction and Basics'
author: "95-868, Spring 2015 Mini 3"
---

## Agenda 

- Course overview 
- R, RStudio, and RMarkdown 
- Programming basics


## R, Rstudio, and RMarkdown

What are R, Rstudio, and RMarkdown?

* **R**: an open source programming language for statistical computing. Like Java, or Python, although MATLAB may be the closest comparison. It's:
    + Free (open-source)
    + Programming language (not point-and-click)
    + Excellent graphics
    + Offers broadest range of statistical tools
    + Easy to generate reproducible reports
    + Easy to integrate with other tools
- **Rstudio**: an environment for using R. (Like how eclipse is an environment for programming in Java). Rstudio's goal is to make R easier and more enjoyable to use -- for example, by adding windows and tabs to keep track of multiple files and output.
- **RMarkdown**: one of many open source "packages" that have been created by independent programmers, to extend the capabilities of R. The goal of RMarkdown is to make it easy to "publish" R code into an html, word, or PDF report, so that other people can read your analysis.


#### Downloading and installing R, Rstudio, and RMarkdown

1. Download and install R: http://lib.stat.cmu.edu/R/CRAN. 
2. Then download and install RStudio: http://www.rstudio.com/. 
3. Open RStudio. Select from the drop-down menu `Tools -> Install Packages...`. In the dialogue box, enter `rmarkdown` as the package to be installed, and click on `install`.


#### RStudio 
  
Rstudio divides the screen into 4 separate windows: 

1. The __Source__ window: create a file that you can save and run later
2. The __Console__ window: type or paste in commands to get output from R
3. The __Workspace/History__ window: see a list of variables or previous commands
4. The __Files/Plots/Packages/Help__ window: see plots, help pages, and other items in this window.



## Basics of using R 

#### The command prompt 

In the console window, R uses a `>` prompt when you are starting a new command.
``` 
  > 2 + 4
  [1] 6
  > (6 + 3) / (1+2)
  [1] 3
  > sqrt(2)
  [1] 1.414214
```

If the previous command is incomplete, R displays a `+`, signifying that you should finish the previous line:
```
  > 2 + sqrt(4 
  + )
  [1] 4
```

In the previous example, we forgot to close the parenthesis on the `sqrt` command, so R displayed a `+` prompt. It is easy to accidentally leave a line unfinished unintentionally this way. If you have an unfinished line and you can't figure out how to end it, you can hit `[ESC]` to abort the command and get back to the `>` prompt.

#### Comments

The `#` symbol is used to denote comments that should be ignored by the R console. Comments are extremely important, because they help you, the reader, understand what the program is trying to do:

```{r}
pi * (15)^2/2  # approx. area of Hamburg Hall Rm 1000 (in sq. yds)
```

Anything that follows a `#` symbol is ignored by the console.

**Note:** In reports generated by R Markdown (such as these lecture notes), the console output is denoted by ##. 


#### Variables

A very important part of R is creating variables to store your intermediate results.

Let's create two variables `x=3` and `y=2`
```{r}
x = 3
y = 2
```

If we want to check the value of a variable, we can type it at the prompt:
```{r}
x
```

Variables can be derived from other variables (`sqrt` is the square root command, `^` raises to the power):
```{r}
z = sqrt(x^2 + y^2)
z
```

Note that variables are not linked, so changing `x` does not automatically change `z`:
```{r}
z = 5
z
```
If we want we can recompute `z` to use the new value of `x`:
```{r}
z = sqrt(x^2 + y^2)
z
```

Not all variables are numeric! We can also create text variables. To differentiate between text data and the name of a variable, enclose the text in either single or double quotes:
```{r}
txt = 'hi there!'
txt2 = "It's cold outside"
```

Variables can also take on boolean (TRUE, FALSE) values. The following commands both set `x` to TRUE:
```{r}
x = TRUE
x = T
```
Boolean values will be very useful for "filtering" your data, as we'll see soon.

**Note:** In R it's common practice to use `<-` instead of the `=` sign. You are free to follow this convention if you like.
```{r}
x <- 42
x
```

#### Vectors (ie, Arrays)

The command `c()` can be used to create a **vector**. A vector is a collection of values. The values must be all the same type; i.e., all booleans, all numeric, etc.

Here we use `c()` to create a vector of students, and a vector of midterm grades:
```{r}
students = c("Sean", "Louisa", "Frank", "Farhad", "Qian")
midterm = c(80, 90, 93, 82, 95)
```
Typing the variable name at the prompt causes it to display, as usual:
```{r}
students
midterm
```

Here are 3 more vectors for the students in our fictional class:
```{r}
final = c(78, 84, 95, 82, 91)
dept = c("MISM", "MSPPM", "MSPPM", "MISM", "EPP")
auditing = c(F, F, F, T, F)
```

You can do arithmetic on vectors. The operation is done on each pair of elements separately
```{r}
average.score = (final + midterm) / 2  # average the midterm and final score for each student
average.score
```

#### Logical tests on a vector

You can check whether each entry of a vector satisfies some logical condition. 

Here we check which elements of `dept` are equal to `MISM` (the operator `==` checks for equality. **Not** to be confused with `=`):
```{r}
dept == 'MISM'  # not the same as dept = 'MISM'
```
Or which elements of `midterm` were above average (the command `mean` takes the average of a vector):
```{r}
midterm > mean(midterm) 
```
We can boolean operators `&` (AND) and `|` (OR) to combine logical tests:
```{r}
midterm > mean(midterm) & final > mean(final)
```

#### Indexing a vector

We will often only want to work with a subset of the data. For vectors this is done by indexing, using `[ ]`.

Extract the 4th and 5th elements of the vector `students`
```{r}
students[ 4:5 ]
```

We create a vector `c(1,3,2)` to extract the 1st, 3rd, and 2nd student names in that order:
```{r}
students[ c(1,3,2) ]  
```

**Change** the 4th and 5th elements of the vector `students`
```{r}
students[4:5] = c('Sir Galahad', 'King Arthur')
```

**Logical indexing:** We can use any boolean vector to extract the elements corresponding to `TRUE`. For example, we can extract the students corresponding to above-average midterm scores:
```{r}
students[ midterm > mean(midterm) ] 
```

What were the final exam scores for these students?

```{r}
final[ midterm > mean(midterm) ]
```

For these students, were their final exam scores also above average?

```{r}
final[ midterm > mean(midterm) ] > mean(final)  # it's getting complicated to parse!
```

#### Functions

The main tasks in R are

1. Creating variables, usually by loading in data and then extracting the subset that you want
2. Running a command or **function** on the variables to do some analysis

A function is a machine that takes inputs, and returns outputs, possibly with some side effects (like creating a plot). 

The inputs are often called the **arguments** of the function. The output is sometimes called the **return value** of the function. The difference between an output and a side effect (such as a plot), is that the output can be saved as a variable, so that it can later be used in yet another funtion. 

The commands `sqrt()`, `c()`, and `mean()` are all examples of functions. Another function is `plot()`. It takes vectors `x` and `y` as arguments, and creates a plot:
```{r, fig.width=3, fig.height=4, fig.align="center"}
plot(x=midterm, y=final) # is there a correlation between high midterm scores and high final exam scores?
```

Functions often have many optional arguments to customize behavior. Here we are adding optional arguments to label the axes:
```{r, fig.width=3, fig.height=4, fig.align="center"}
plot(x=midterm, y=final, main='Exam Scores, 95-868', xlab='Midterm Scores', ylab='Final Exam Scores')
```

If you don't name the arguments, R will assume they follow some default ordering:
```{r, fig.width=3, fig.height=4, fig.align="center"}
plot(midterm, final) 
```

The help page for each function will usually tell you the arguments and their names (or link to another page that does). Typing `?plot` will open the help page for `plot()`.

#### Dataframes

```{r echo=FALSE}
classrec = data.frame(name=students, dept=dept, midterm=midterm, final=final, auditing=auditing)
```

A data frame is like a spreadsheet with rows and columns. Here is a small data frame, called `classrec`, which contains the vectors that we saw earlier. It has 5 rows and 5 columns

```{r}
classrec
```

#### Indexing data frames

To extract a single column from `classrec`, use the `$` symbol:
```{r}
classrec$final
```
You can index the column as a vector:
```{r}
classrec$final[1:3]
classrec$final[ classrec$midterm > 90 ]
```
You can also add or replace columns using the `$` symbol:
```{r}
classrec$quiz = c(98, 99, 97, 96, 95)  # add a new column for a quiz
classrec$final = c(90, 90, 92, 94, 88) # change the final scores to 90, 90, 92, 94, 88
classrec
```
You can index data frames like vectors, using the '[ ]' notation
```{r}
classrec[ 1:3, 2:5 ] # extract rows 1-3, cols 2-5
classrec[ 1:3, ] # extract rows 1-3, all cols
classrec[ ,2:5] # extract all rows, cols 2-5
classrec[, "final"] # will be useful in a few weeks
```

#### The `subset()` command
Usually the best way to extract a subset from a data frame is to use the `subset()` command. For example:
```{r}
subset(classrec, select=c('name', 'midterm', 'final'), subset = auditing==F & midterm < 90)
```
For complicated filtering operations, `subset()` is the easiest way to read and check for correctness. It takes three main arguments:

Argument | Description
-----|-------
`x` | the data frame to be subsetted
`subset` | logical expression indicating which rows to keep
`select` | vector of columns to keep 

## Introduction to R Markdown

R Markdown is a convenient way of writing reports with built-in R code to do the analysis. This is advantageous for many reasons:

* It's easy for readers to see what you are doing
* As the data or code changes, so does the report
* No more need to copy-and-paste graphics, tables, or numbers to keep the report up to date
* The results are **reproducible**. Anyone who has your R Markdown file and input data can re-run your analysis and get the exact same results
* Can output report in HTML (default), Word, or PDF

R Markdown has various syntax that we will cover later. The most important things are:

* R Markdown files have the extension .Rmd at the end of their filename
* To create a new markdown file, select the dropdown menu option `File -> New File -> R Markdown...`. A short template file will be created for you to fill in.
* To create the report from the .Rmd file, click "Knit HTML" from the ribbon in the files window.

The easiest way to get started is to open a markdown file and edit it. Open the file `quiz1.Rmd` and see if you can fill in the missing R commands! You may need to read the reference material at the end of this lecture to answer all the questions.

You may also want to check out the online introduction: http://shiny.rstudio.com/articles/rmarkdown.html

## Self-study Material

For your reference, here are additional functions and commands that are similar to those used in the lecture.

#### Keyboard shortcuts in Rstudio

https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts

Keystroke | Description
----------|-------------
`<tab>` | autocompletes commands and filenames, and lists arguments for functions. Highly useful!
`<up>` | cycle through previous commands in the console prompt
`<ctrl-up>` | lists history of previous commands matching an unfinished one
`<ctrl-enter>` | paste current line from source window to console. Good for trying a source file "line-by-line".
`<ESC>` | abort an unfinished command and get out of the `+` prompt

#### Arithmetic operators in R

Command | Description
--------|-------------
`+,-,*,\` | add, subtract, multiply, divide
`^` | raise to the power of
`%%` | remainder after division (ex: `8 %% 3 = 2`)
`( )` | change the order of operations
`log(), exp()` | logarithms and exponents (ex: `log(10) = 2.302`)
`sqrt()` | square root
`round()` | round to the nearest whole number (ex: `round(2.3) = 2`)
`floor(), ceiling()` | round down or round up 
`abs()` | absolute value

#### Commands to create vectors

Command | Description  |  Example
--------|--------------|---------
`c()`   | combines variables into a single vector |  `midterm = c(80,90,93,82,95)`
`rep()` | repeats elements |  `rep(3, times=5)` returns `3 3 3 3 3`
`seq()` | creates a sequence |  `seq(from=3, to=10, by=2)` returns `3 5 7 9`
`:`     | counts | `4:7` returns `4 5 6 7`

Note: `c(vec1, vec2)` returns the combination of `vec1` and `vec2`. Similar for `rep()`.
```{r}
# concatenate the vectors students and dept:
long.vector = c(students, dept)
long.vector
# repeat the vector students, 2 times:
repeated.vector = rep(students, times=2)
repeated.vector
```

#### Commands that operate on vectors

Command | Description
--------|------------
`sum(vec)` | sums up all the elements of `vec`
`mean(vec)` | returns the mean of `vec`
`median(vec)` | returns the median of `vec` 
`min(vec), max(vec)` | the largest or smallest element of `vec`
`sd(vec), var(vec)` | the standard deviation and variance of `vec`
`length(vec)` | the number of elements in `vec`
`pmax(vec1, vec2), pmin(vec1, vec2)` | example: `pmax(quiz1, quiz2)` returns the higher of quiz 1 and quiz 2 for each student
`sort(vec)` | returns the `vec` in sorted order
`order(vec)` | returns the index that sorts the vector `vec`
`unique(vec)` | lists the unique elements of `vec`
`length(vec)` | how many elements are in `vec`?

#### Operators for logical tests

Operator | Description
---------|------------
`x == y` | is `x` the same as `y`
`x != y` | is `x` not the same as `y`
`<, >, <=, >=` | less than, greater than, less than or equal to, greater than or equal to
`&` | and
`|` | or
`!` | not
`x %in% y` | which elements of `x` are also in `y`?
`is.na(x)` | which elements of `x` are equal to `NA`, denoting missing data
`any(vec)` | are any elements of `vec` equal to TRUE?
`all(vec)` | are all elements of `vec` equal to TRUE?

#### Examples of `sort` and `order`

```{r}
sort(final) # returns the final exam scores in sorted order
sort(final, decreasing = TRUE) # sorts in decreasing order
order(final) # returns the vector that sorts final
final[ order(final) ] # this should be sorted if everything worked
students[ order(final) ] # order the student names by their final exam scores
classrec[ order(classrec$final), ] # also works for data frames
```

#### Other auxillary commands

Command | Description
--------|------------
`ls()` | List all variables in memory
`rm(x)` | Clear the variable named x from memory
`rm(list=ls())` | Clear all variables from memory (NOTE: don't put this in any file someone else might run, like your homework!)
`options(digits = 3)` | R only displays 3 significant digits of each number (it may be easier to read the output this way)
`q()` | Quit R
`?function` | Loads the help page for `function`
`??"phrase"` | Searches help for any pages mentioning `phrase`

Using the pull-down menus in Rstudio, you can change the working directory. You can also install (i.e., download) packages, which are expansions to R containing additional commands. (such as the `rmarkdown` package that we installed already)


